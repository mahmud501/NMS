{% extends "base.html" %}

{% block title %}NMS - {{page_title}}{% endblock %}

{% block content %}
<div class="gap-view"></div>
<div class="net-dashboard">
    <h3>{{page_title}}</h3>
    <div class="alert alert-warning mb-4">
    <strong>Warning:</strong> This action is <strong>permanent</strong> and cannot be undone.
    All associated interfaces, stats, and availability data will also be deleted.
    </div>
</div>
<div class="">
    <p style="padding: 5px; font-weight: bold;">Delete Device</p>
    <form id="deleteForm" method="POST" action="{{ url_for('api_delete_device') }}">
        <div class="mb-4 row align-items-center">
            <label for="device_select" class="col-sm-4 col-form-label fw-bold">
                Device:
            </label>

            <div class="col-sm-6">
                <select class="form-select" id="device_select" name="device_id" required>
                    <option value="" selected>-- Select Device IP --</option>
                    {% for device in devices %}
                        <option value="{{ device.device_id }}">{{ device.ip_address }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="mb-4 row align-items-center">
            <label for="confirm_delete" class="col-sm-4 col-form-label fw-bold text-danger">
                Confirm deletion:
            </label>

            <div class="col-sm-6">
                <input class="form-check-input" type="checkbox"
                    id="confirm_delete" name="confirm_delete">
            </div>
        </div>
        <button type="submit" class="btn btn-danger" id="deleteBtn" disabled>
            Delete Device
        </button>
        <a href="{{ url_for('device_list', device_type='all') }}" class="btn btn-secondary ms-2">Cancel</a>
    </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const checkbox = document.getElementById("confirm_delete");
    const select = document.getElementById("device_select");
    const deleteBtn = document.getElementById("deleteBtn");

    function updateButton() {
        const isChecked = checkbox.checked;
        const isSelected = select.value !== "";
        deleteBtn.disabled = !(isChecked && isSelected);
    }

    checkbox.addEventListener("change", updateButton);
    select.addEventListener("change", updateButton);
});
</script>

{% endblock %}